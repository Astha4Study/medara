import{a as m,j as e,L as h,H as g,t as d,r as p,s as b}from"./app-DPU-5xaA.js";import{H as r}from"./highlight-DUR8rx6z.js";import{C as j,a as f}from"./chevron-up-Crs5jcta.js";import{A as y,b as v,c as k,d as N,e as D,f as w,g as _,h as R}from"./alert-dialog-C-ihqo6s.js";import{A}from"./app-layout-i-Fpipg8.js";import{u as C}from"./catatan-layanan.store-CO1wcFyV.js";import"./app-BZ19I5NX.js";import"./utils-C8uvsPt5.js";import"./index-BtRVbgEg.js";import"./app-logo-icon-xsYHPLvD.js";import"./x-DTHQ_Ru-.js";import"./index-4Ns3tNZl.js";const S=s=>{if(!s)return"-";const a=new Date(s);if(isNaN(a.getTime()))return"-";const t=new Date;let l=t.getFullYear()-a.getFullYear();const n=t.getMonth()-a.getMonth();return(n<0||n===0&&t.getDate()<a.getDate())&&l--,`${l} tahun`},T=({pasien:s,pemeriksaanFisik:a})=>{const[t,l]=m.useState(!1);return e.jsxs("div",{className:"rounded-t-lg border-b bg-gray-50",children:[e.jsxs("button",{type:"button",onClick:()=>l(!t),className:"flex w-full items-center justify-between px-6 py-4 text-left",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-800",children:"Ringkasan Pasien & Pemeriksaan"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Digunakan sebagai referensi penulisan resep"})]}),t?e.jsx(j,{className:"h-4 w-4 text-gray-500"}):e.jsx(f,{className:"h-4 w-4 text-gray-500"})]}),t&&e.jsxs("div",{className:"space-y-6 border-t bg-white px-6 pb-6",children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-gray-700",children:"Informasi Pasien"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(r,{label:"Nama Pasien",value:s.nama_lengkap}),e.jsx(r,{label:"Nomor Pasien",value:s.nomor_pasien}),e.jsx(r,{label:"Umur",value:S(s.tanggal_lahir)}),e.jsx(r,{label:"Golongan Darah",value:s.golongan_darah}),e.jsx(r,{className:"md:col-span-2",label:"Riwayat Penyakit",value:s.riwayat_penyakit,multiline:!0}),e.jsx(r,{className:"md:col-span-2",label:"Alergi",value:s.alergi,multiline:!0})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(r,{label:"Berat Badan",value:a.berat_badan?`${a.berat_badan} kg`:void 0}),e.jsx(r,{label:"Tekanan Darah",value:a.tekanan_darah?`${a.tekanan_darah} mmHg`:void 0}),e.jsx(r,{label:"Suhu Tubuh",value:a.suhu_tubuh?`${a.suhu_tubuh} Â°C`:void 0}),a.kondisi_khusus&&e.jsx(r,{className:"md:col-span-2",label:"Kondisi Khusus",value:a.kondisi_khusus,multiline:!0})]})})]})]})};function P({pasien:s,processing:a,error:t,onConfirm:l}){const[n,i]=m.useState(""),[c,o]=m.useState(!1),u=()=>{o(!1),l(n)};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{children:[e.jsx("div",{className:"space-y-4 p-6",children:e.jsxs("div",{className:"bg-white",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h4",{className:"text-base font-medium text-gray-700",children:"Tulis resep medis untuk pasien"}),e.jsx("span",{className:"rounded-md bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-700",children:"Resep Dokter"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("textarea",{rows:8,placeholder:`Contoh:
R/ Amoxicillin 500 mg
S 3 dd 1
Habiskan`,value:n,onChange:x=>i(x.target.value),className:"w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm placeholder:text-gray-400"}),t&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t})]})]})}),e.jsxs("div",{className:"border-gray-199 flex justify-end gap-3 rounded-b-lg border-t bg-gray-50 px-6 py-4",children:[e.jsx(h,{href:`/dokter/antrian/${s.id}/tangani`,className:"rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Batal"}),e.jsx("button",{type:"button",disabled:a||!n.trim(),onClick:()=>o(!0),className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-medium text-white hover:bg-emerald-700 disabled:opacity-50",children:a?"Menyimpan...":"Simpan Resep"})]})]}),e.jsx(y,{open:c,onOpenChange:o,children:e.jsxs(v,{children:[e.jsxs(k,{children:[e.jsx(N,{children:"Konfirmasi Resep Dokter"}),e.jsx(D,{children:"Pastikan resep yang Anda tulis sudah benar dan jelas, karena akan diproses oleh apoteker."})]}),e.jsxs(w,{children:[e.jsx(_,{children:"Batal"}),e.jsx(R,{onClick:u,className:"bg-emerald-600 hover:bg-emerald-700",children:"Yakin, simpan resep"})]})]})})]})}function q({pasien:s,pemeriksaan_fisik:a}){const{data:t}=C(),l=i=>{if(!i.trim()){d.error("Resep tidak boleh kosong");return}p.post(b("dokter.resep.store-final"),{catatan:t,resep_teks:i,pasien_id:s.id},{preserveScroll:!0,onSuccess:()=>{d.success("Resep berhasil dikirim ke apotek")},onError:()=>{d.error("Gagal menyimpan resep")}})},n=[{title:"Daftar Antrian",href:"/dokter/antrian"},{title:"Buat Tindakan Dokter",href:"#"},{title:"Siapkan Resep",href:""}];return e.jsxs(A,{breadcrumbs:n,children:[e.jsx(g,{title:"Siapkan Resep"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["Resep untuk ",s.nama_lengkap]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Tulis resep seperti tulisan dokter pada umumnya"})]}),e.jsxs("div",{className:"rounded-lg border bg-white",children:[e.jsx(T,{pasien:s,pemeriksaanFisik:a}),e.jsx(P,{onConfirm:l,pasien:s,processing:!1})]})]})]})}export{q as default};
