import{j as e,L as f,b as j,a as m,H as y,r as _,t as p}from"./app-DPU-5xaA.js";import{A as N,b as v,c as k,d as A,e as C,f as D,g as E,h as P}from"./alert-dialog-C-ihqo6s.js";import{A as U}from"./app-layout-i-Fpipg8.js";import"./app-BZ19I5NX.js";import"./index-BtRVbgEg.js";import"./app-logo-icon-xsYHPLvD.js";import"./utils-C8uvsPt5.js";import"./x-DTHQ_Ru-.js";import"./index-4Ns3tNZl.js";const S=({data:r,setData:l,handleSubmit:a,processing:o,availableRoles:d,errors:t,isDirty:i})=>e.jsx("form",{onSubmit:a,autoComplete:"off",children:e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Nama Lengkap ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.name,onChange:s=>l("name",s.target.value),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"}),t.name&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:r.email,onChange:s=>l("email",s.target.value),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"}),t.email&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Password Lama"}),e.jsx("input",{type:"password",autoComplete:"current-password",value:r.current_password,onChange:s=>l("current_password",s.target.value),placeholder:"Masukkan password lama",className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"}),t.current_password&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.current_password})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Password Baru"}),e.jsx("input",{type:"password",autoComplete:"new-password",value:r.new_password,onChange:s=>l("new_password",s.target.value),placeholder:"Kosongkan jika tidak ingin mengubah",className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"}),t.new_password&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.new_password})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Konfirmasi Password Baru"}),e.jsx("input",{type:"password",autoComplete:"new-password",value:r.new_password_confirmation,onChange:s=>l("new_password_confirmation",s.target.value),placeholder:"Konfirmasi password baru",className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"}),t.new_password_confirmation&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.new_password_confirmation})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Role ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:r.role,onChange:s=>l("role",s.target.value),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",children:d.map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),t.role&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.role})]})]}),e.jsx("div",{className:"border-t border-gray-200 bg-gray-50 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx(f,{href:"/admin/tambah-user",className:"rounded-lg border border-gray-200 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Batal"}),e.jsx("button",{type:"submit",disabled:o||!i,className:"rounded-lg bg-emerald-600 px-4 py-2.5 text-sm font-medium text-white hover:bg-emerald-700 disabled:opacity-50",children:o?"Menyimpan...":"Simpan Perubahan"})]})})]})}),L=[{title:"Daftar User",href:"/admin/tambah-user"},{title:"Edit User",href:""}];function I({user:r,availableRoles:l}){const{data:a,setData:o,processing:d,errors:t}=j({name:r.name||"",email:r.email||"",role:r.role||"",current_password:"",new_password:"",new_password_confirmation:""}),[i,s]=m.useState(!1),[x,u]=m.useState(!1),c=a.current_password.length>0&&a.new_password.length>0&&a.new_password_confirmation.length>0&&a.new_password===a.new_password_confirmation;m.useEffect(()=>{const n={name:r.name||"",email:r.email||"",role:r.role||""},w=a.name!==n.name||a.email!==n.email||a.role!==n.role,b=a.current_password.length>0||a.new_password.length>0||a.new_password_confirmation.length>0;u(w||b&&c)},[a,r]);const h=()=>{const n=new FormData;n.append("name",a.name),n.append("email",a.email),n.append("role",a.role),c&&(n.append("current_password",a.current_password),n.append("new_password",a.new_password),n.append("new_password_confirmation",a.new_password_confirmation)),_.post(`/admin/users/${r.id}?_method=PUT`,n,{onSuccess:()=>{p.success("User berhasil diperbarui",{description:"Data user telah berhasil disimpan ke sistem."})},onError:()=>{p.error("Gagal memperbarui user",{description:"Periksa kembali data yang diinput."})}})},g=n=>{n.preventDefault(),s(!0)};return e.jsxs(U,{breadcrumbs:L,children:[e.jsx(y,{title:"Edit User"}),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"mb-1 text-2xl font-semibold text-gray-900",children:"Edit Data User"}),e.jsx("p",{className:"mb-6 text-sm text-gray-500",children:"Perbarui informasi user di bawah ini."}),e.jsx("div",{className:"overflow-hidden",children:e.jsx(S,{data:a,setData:o,handleSubmit:g,processing:d,availableRoles:l,errors:t,isDirty:x})})]}),e.jsx(N,{open:i,onOpenChange:s,children:e.jsxs(v,{children:[e.jsxs(k,{children:[e.jsx(A,{children:"Konfirmasi Perubahan"}),e.jsx(C,{children:"Pastikan data user sudah benar sebelum disimpan."})]}),e.jsxs(D,{children:[e.jsx(E,{children:"Batal"}),e.jsx(P,{onClick:h,children:"Simpan"})]})]})})]})}export{I as default};
