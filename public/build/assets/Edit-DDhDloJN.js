import{j as e,a as u,L as _,b as R,H as A,s as C,t as b}from"./app-DPU-5xaA.js";import{H as j}from"./highlight-DUR8rx6z.js";import{D as O}from"./data-pemeriksaan-fisik-DiKnpJ3n.js";import{A as P,b as S,c as L,d as F,e as H,f as E,g as M,h as T}from"./alert-dialog-C-ihqo6s.js";import{A as B}from"./app-layout-i-Fpipg8.js";import"./app-BZ19I5NX.js";import"./utils-C8uvsPt5.js";import"./index-BtRVbgEg.js";import"./app-logo-icon-xsYHPLvD.js";import"./x-DTHQ_Ru-.js";import"./index-4Ns3tNZl.js";const I=({pasien:s,diagnosa:n,punya_server:l})=>{const c=s.riwayat_penyakit&&s.riwayat_penyakit.trim()!==""&&s.riwayat_penyakit!=="-",d=n&&n.trim()!==""&&n!=="-";return e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Informasi Pasien & Diagnosa"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Data identitas pasien dan hasil pemeriksaan dokter"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Nomor Pasien"}),e.jsx("div",{className:"rounded-lg border bg-gray-50 px-4 py-2.5 text-sm text-gray-900",children:s.nomor_pasien})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Nama Lengkap"}),e.jsx("div",{className:"rounded-lg border bg-gray-50 px-4 py-2.5 text-sm text-gray-900",children:s.nama_lengkap})]})]}),c&&e.jsx(j,{label:"Riwayat Penyakit",value:s.riwayat_penyakit,className:"mt-2"}),e.jsx("div",{className:"mt-2",children:l===1&&d?e.jsx(j,{label:"Diagnosa Dokter",value:n}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",disabled:!0,value:"Data ditulis manual, jangan lupa dicek kembali",className:"w-full rounded-lg border border-emerald-200 bg-emerald-50 px-4 py-2.5 pr-10 text-sm font-medium text-emerald-800"}),e.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-3 flex items-center",children:e.jsx("svg",{className:"h-5 w-5 text-emerald-600",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.79 1.732-3L13.732 4c-.77-1.79-2.502-1.79-3.268 0L3.34 16c-.77 1.79.192 3 1.732 3z"})})})]})})]})})};function z({resep_teks:s}){return e.jsx("div",{className:"mb-6 rounded-lg border border-gray-200 bg-white shadow-sm",children:e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Resep Medis Dokter"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Resep yang ditulis oleh dokter sebagai acuan penyiapan obat"})]}),e.jsx("span",{className:"rounded-md bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-700",children:"Resep Dokter"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("textarea",{rows:4,value:s||"-",disabled:!0,className:"w-full resize-none rounded-md border border-gray-200 bg-gray-50 px-3 py-2 text-sm leading-relaxed text-gray-700"})})]})})}function q({obat_list:s,processing:n,errors:l,onConfirm:c,onChange:d,pasien:p}){const[i,g]=u.useState([]),y=()=>g(a=>[...a,{obat_id:0,nama_obat:"",jumlah:1,satuan:"",harga:0,subtotal:0,penggunaan_obat:""}]),o=(a,t,r)=>{g(x=>{const m=[...x];if(m[a]={...m[a],[t]:r},t==="jumlah"||t==="harga"||t==="obat_id"){const w=t==="obat_id"?s.find(D=>D.id===r)?.harga??m[a].harga:m[a].harga;m[a].subtotal=m[a].jumlah*w}return m})},f=a=>g(t=>t.filter((r,x)=>x!==a)),N=i.reduce((a,t)=>a+t.harga*t.jumlah,0),h=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),v=(a,t)=>{const r=s.find(x=>x.id===t);r&&(o(a,"obat_id",t),o(a,"nama_obat",r.nama_obat),o(a,"satuan",r.satuan),o(a,"harga",r.harga),o(a,"penggunaan_obat",r.penggunaan_obat))},k=a=>{a.preventDefault(),i.length!==0&&c()};return u.useEffect(()=>{d(i)},[i]),e.jsx("form",{onSubmit:k,children:e.jsxs("div",{className:"rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"space-y-4",children:[i.map((a,t)=>e.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Obat ke-",t+1]}),e.jsx("button",{type:"button",onClick:()=>f(t),className:"rounded-md px-2 py-1 text-xs text-red-600 hover:bg-red-50",children:"Hapus"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Nama Obat"}),e.jsxs("select",{value:a.obat_id,onChange:r=>v(t,Number(r.target.value)),required:!0,className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm",children:[e.jsx("option",{value:0,children:"-- Pilih Obat --"}),s.map(r=>e.jsxs("option",{value:r.id,children:[r.nama_obat," (",r.satuan,")"]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Jumlah"}),e.jsx("input",{type:"number",min:1,value:a.jumlah,onChange:r=>o(t,"jumlah",Number(r.target.value)),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Harga Satuan"}),e.jsx("input",{type:"text",value:h(a.harga),readOnly:!0,className:"w-full cursor-not-allowed rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-sm text-gray-600"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Aturan Pakai"}),e.jsx("input",{type:"text",value:a.penggunaan_obat,onChange:r=>o(t,"penggunaan_obat",r.target.value),placeholder:"3Ã—1 sehari",className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm"})]})]})]},t)),e.jsx("button",{type:"button",onClick:y,className:"w-full rounded-lg border border-dashed border-gray-300 px-4 py-3 text-sm text-gray-600 hover:border-emerald-500 hover:text-emerald-600",children:"+ Tambah Obat"})]}),l.general&&e.jsx("p",{className:"text-sm text-red-600",children:l.general}),e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-gray-200 bg-white px-5 py-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total"}),e.jsx("span",{className:"rounded-md bg-emerald-50 px-2.5 py-1 text-xs font-semibold text-emerald-700",children:"Sudah termasuk PPN"})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Rp"}),e.jsx("span",{className:"text-xl font-semibold tracking-tight text-gray-900",children:h(N).replace("Rp","")})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 rounded-b-xl border-t border-gray-200 bg-gray-50 px-6 py-4",children:[e.jsx(_,{href:`/dokter/antrian/${p.id}/tangani`,className:"rounded-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Batal"}),e.jsx("button",{type:"submit",disabled:n||i.length===0,className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-medium text-white hover:bg-emerald-700 disabled:opacity-50",children:n?"Menyimpan...":"Simpan Resep"})]})]})})}const J=[{title:"Resep Masuk",href:"/apoteker/resep-masuk"},{title:"Siapkan Obat Pasien",href:""}];function ae({resep:s,obatMaster:n}){const l=R({detail:[]}),[c,d]=u.useState(!1),p=()=>{l.post(C("apoteker.resep-detail.store",s.id),{preserveScroll:!0,onSuccess:()=>{d(!1),b.success("Resep berhasil dibuat")},onError:()=>{b.error("Terjadi kesalahan saat membuat resep")}})};return e.jsxs(B,{breadcrumbs:J,children:[e.jsx(A,{title:"Siapkan Obat Pasien"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsx(I,{pasien:s.pasien,diagnosa:s.diagnosa,punya_server:s.punya_server}),e.jsx(O,{pemeriksaanFisik:s.pemeriksaan_fisik})]}),e.jsx(z,{resep_teks:s.resep_teks}),e.jsx(q,{obat_list:n,processing:l.processing,errors:l.errors,pasien:s.pasien,onChange:i=>l.setData("detail",i),onConfirm:()=>d(!0)})]}),e.jsx(P,{open:c,onOpenChange:d,children:e.jsxs(S,{children:[e.jsxs(L,{children:[e.jsx(F,{children:"Konfirmasi Pengecekan Obat"}),e.jsx(H,{children:"Apakah kamu yakin sudah mengecek obat dengan baik dan sesuai dengan resep dokter?"})]}),e.jsxs(E,{children:[e.jsx(M,{disabled:l.processing,children:"Batal"}),e.jsx(T,{onClick:p,disabled:l.processing,className:"bg-emerald-600 hover:bg-emerald-700",children:"Ya, Sudah Dicek"})]})]})})]})}export{ae as default};
