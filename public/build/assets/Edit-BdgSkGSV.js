import{a as p,j as e,L as _,b as w,H as A,r as K,t as x}from"./app-DPU-5xaA.js";import{u as C,M as E,P,L as h,a as S,T as M}from"./TileLayer-CVeavWrT.js";import{B as T}from"./building-2-BE9RAvNv.js";import{M as B,P as L,a as O,B as U}from"./phone-DYECNFkh.js";import{E as H}from"./image-BUqEHnll.js";import{P as D}from"./preview-edit-klinik-D2BCtAqt.js";import{A as F,b as G,c as z,d as J,e as R,f as $,g as I,h as q}from"./alert-dialog-C-ihqo6s.js";import{A as V}from"./app-layout-i-Fpipg8.js";import"./app-BZ19I5NX.js";import"./utils-C8uvsPt5.js";import"./index-BtRVbgEg.js";import"./app-logo-icon-xsYHPLvD.js";import"./x-DTHQ_Ru-.js";import"./index-4Ns3tNZl.js";const W=h.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});h.Marker.prototype.options.icon=W;const Z=({latitude:a,longitude:s,setData:i})=>{const[m,n]=p.useState([Number(a)||-7.7956,Number(s)||110.3695]);return C({click(r){n([r.latlng.lat,r.latlng.lng]),i("latitude",r.latlng.lat),i("longitude",r.latlng.lng)}}),e.jsx(E,{draggable:!0,position:m,eventHandlers:{dragend:r=>{const t=r.target.getLatLng();n([t.lat,t.lng]),i("latitude",t.lat),i("longitude",t.lng)}},children:e.jsx(P,{children:"Geser marker atau klik peta untuk ubah posisi."})})},Q=({data:a,setData:s,handleSubmit:i,handleChangeFile:m,processing:n,isDirty:r,errors:o={}})=>e.jsxs("form",{onSubmit:i,className:"col-span-2 space-y-6 rounded-xl border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(T,{className:"h-4 w-4 text-emerald-600"}),"Nama Klinik",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.nama_klinik,onChange:t=>s("nama_klinik",t.target.value),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm text-gray-700 transition focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",placeholder:"Masukkan Nama klinik"}),o.nama_klinik&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:o.nama_klinik})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:["Jenis Klinik ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:a.jenis_klinik,onChange:t=>s("jenis_klinik",t.target.value),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm text-gray-700",children:[e.jsx("option",{value:"Umum",children:"Umum"}),e.jsx("option",{value:"Gigi",children:"Gigi"}),e.jsx("option",{value:"THT",children:"THT"}),e.jsx("option",{value:"Kulit",children:"Kulit"}),e.jsx("option",{value:"Kandungan",children:"Kandungan"}),e.jsx("option",{value:"Anak",children:"Anak"}),e.jsx("option",{value:"Bedah",children:"Bedah"}),e.jsx("option",{value:"Mata",children:"Mata"}),e.jsx("option",{value:"Saraf",children:"Saraf"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(B,{className:"h-4 w-4 text-emerald-600"})," Alamat"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.alamat,onChange:t=>s("alamat",t.target.value),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm text-gray-700",placeholder:"Alamat lengkap"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",value:a.kota,onChange:t=>s("kota",t.target.value),className:"rounded-lg border border-gray-200 px-4 py-2.5 text-sm text-gray-700",placeholder:"Kota"}),e.jsx("input",{type:"text",value:a.provinsi,onChange:t=>s("provinsi",t.target.value),className:"rounded-lg border border-gray-200 px-4 py-2.5 text-sm text-gray-700",placeholder:"Provinsi"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(L,{className:"h-4 w-4 text-emerald-600"}),"Telepon ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.no_telepon,onChange:t=>s("no_telepon",t.target.value),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm text-gray-700"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(O,{className:"h-4 w-4 text-emerald-600"})," Email"]}),e.jsx("input",{type:"email",value:a.email,onChange:t=>s("email",t.target.value),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm text-gray-700"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(U,{className:"h-4 w-4 text-emerald-600"})," ","Kapasitas Total ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:a.kapasitas_total,onChange:t=>s("kapasitas_total",Number(t.target.value)),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-gray-700",children:["Tempat Tersedia ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:a.kapasitas_tersedia,onChange:t=>s("kapasitas_tersedia",Number(t.target.value)||0),className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(H,{className:"h-4 w-4 text-emerald-600"}),"Koordinat Lokasi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",disabled:!0,placeholder:"Latitude",value:a.latitude,onChange:t=>s("latitude",t.target.value),className:"rounded-lg border border-gray-200 bg-gray-100 px-4 py-2.5 text-sm text-gray-700 transition focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"}),e.jsx("input",{type:"text",disabled:!0,placeholder:"Longitude",value:a.longitude,onChange:t=>s("longitude",t.target.value),className:"rounded-lg border border-gray-200 bg-gray-100 px-4 py-2.5 text-sm text-gray-700 transition focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"})]})]}),e.jsx("div",{className:"mt-4 h-[300px] w-full overflow-hidden rounded-lg border border-gray-200",children:e.jsxs(S,{center:[Number(a.latitude)||-7.7956,Number(a.longitude)||110.3695],zoom:13,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[e.jsx(M,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(Z,{latitude:a.latitude,longitude:a.longitude,setData:s})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium text-gray-700",children:["Deskripsi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:a.deskripsi,onChange:t=>s("deskripsi",t.target.value),rows:4,placeholder:"Tuliskan deskripsi singkat tentang klinik...",className:"w-full resize-none rounded-lg border border-gray-200 px-4 py-2.5 text-sm text-gray-700 transition focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Gambar"}),e.jsx("input",{type:"file",accept:"image/*",onChange:m,className:"block w-full rounded-lg border border-gray-200 text-sm text-gray-700 file:rounded-lg file:bg-emerald-50 file:px-4 file:py-2 file:text-emerald-700"})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[e.jsx(_,{href:"/admin/klinik",className:"rounded-lg border border-gray-200 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Batal"}),e.jsx("button",{type:"submit",disabled:n||!r,className:`rounded-lg px-4 py-2.5 text-sm font-medium text-white transition disabled:cursor-not-allowed ${n||!r?"bg-emerald-600 opacity-50":"bg-emerald-600 hover:bg-emerald-700"}`,children:n?"Menyimpan...":"Simpan Perubahan"})]})]}),X=[{title:"Klinik Kamu",href:"/admin/klinik"},{title:"Edit Klinik Kamu",href:""}];function ue({klinik:a}){const{data:s,setData:i,processing:m,errors:n}=w({nama_klinik:a.nama_klinik??"",jenis_klinik:a.jenis_klinik??"",alamat:a.alamat??"",kota:a.kota??"",provinsi:a.provinsi??"",no_telepon:a.no_telepon??"",email:a.email??"",deskripsi:a.deskripsi??"",latitude:a.latitude??"",longitude:a.longitude??"",kapasitas_total:a.kapasitas_total??0,kapasitas_tersedia:a.kapasitas_tersedia??0,punya_apoteker:!!a.punya_apoteker,punya_server:!!a.punya_server,gambar:void 0}),[r,o]=p.useState(!1),[t,b]=p.useState(!1),f=(l,d)=>JSON.stringify(l)===JSON.stringify(d);p.useEffect(()=>{const l={nama_klinik:a.nama_klinik??"",jenis_klinik:a.jenis_klinik??"",alamat:a.alamat??"",kota:a.kota??"",provinsi:a.provinsi??"",no_telepon:a.no_telepon??"",email:a.email??"",deskripsi:a.deskripsi??"",latitude:a.latitude??"",longitude:a.longitude??"",kapasitas_total:a.kapasitas_total??0,kapasitas_tersedia:a.kapasitas_tersedia??0,punya_apoteker:!!a.punya_apoteker,punya_server:!!a.punya_server};b(!f(s,l))},[s,a]);const[j,y]=p.useState(a.gambar?`/storage/${a.gambar}`:null),v=l=>{if(l.target.files&&l.target.files[0]){const d=l.target.files[0];i("gambar",d),y(URL.createObjectURL(d))}},N=l=>{const d=new FormData;Object.entries(s).forEach(([c,u])=>{if(u!=null){const g=u;g instanceof Blob?d.append(c,g):d.append(c,String(g))}}),K.post(`/admin/klinik/${a.id}?_method=PUT`,d,{onSuccess:()=>{x.success("Klinik berhasil diperbarui",{description:"Data klinik telah berhasil disimpan ke sistem."}),o(!1)},onError:c=>{x.error("Gagal memperbarui klinik",{description:"Terjadi kesalahan saat menyimpan data klinik."}),console.error(c),o(!1)}})},k=l=>{l.preventDefault(),o(!0)};return e.jsxs(V,{breadcrumbs:X,children:[e.jsx(A,{title:"Edit Klinik Kamu"}),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"mb-1 text-2xl font-semibold text-gray-900",children:"Edit Data Klinik"}),e.jsx("p",{className:"mb-6 text-sm text-gray-500",children:"Perbarui informasi klinik di bawah ini."}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Q,{data:s,setData:i,isDirty:t,handleSubmit:k,handleChangeFile:v,processing:m,errors:n})}),e.jsx("div",{className:"self-start",children:e.jsx(D,{data:{...s,preview:j}})})]}),e.jsx(F,{open:r,onOpenChange:o,children:e.jsxs(G,{className:"modal-over-map",children:[e.jsxs(z,{children:[e.jsx(J,{children:"Konfirmasi Perubahan"}),e.jsx(R,{children:"Apakah Anda yakin ingin menyimpan perubahan data klinik ini? Pastikan seluruh informasi yang dimasukkan sudah benar."})]}),e.jsxs($,{children:[e.jsx(I,{children:"Batal"}),e.jsx(q,{className:"bg-emerald-600 hover:bg-emerald-700",onClick:()=>N(),children:"Simpan"})]})]})})]})]})}export{ue as default};
